"use strict";(self.webpackChunkcaa_client=self.webpackChunkcaa_client||[]).push([[880],{32739:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(89164),i=t(53767),a=t(20890),s=t(80184);function o(e){var n=e.user;return(0,s.jsx)(r.Z,{maxWidth:"md",sx:{height:"100%",py:4},children:(0,s.jsxs)(i.Z,{sx:{justifyContent:"center",minHeight:"50%",p:4,background:"url(/editing.svg) #eee8",backgroundRepeat:"no-repeat",backgroundPosition:"top right",backgroundSize:"400px 400px"},gap:2,children:[(0,s.jsx)(a.Z,{variant:"h3",color:"#cce",fontWeight:700,sx:{letterSpacing:"20px"},children:"Waiting..."}),!!n&&(0,s.jsxs)(a.Z,{variant:"h6",color:"#a20",children:[n.name," - ",n.email]}),(0,s.jsx)(a.Z,{variant:"h4",color:"#f90",children:"\u73fe\u5728\u7de8\u96c6\u3057\u3066\u3044\u307e\u3059"})]})})}},18251:function(e,n,t){t.r(n),t.d(n,{default:function(){return N}});var r=t(74165),i=t(15861),a=t(29439),s=t(53767),o=t(20890),c=t(39253),u=t(32739),l=t(43859),d=t(98074),f=t(61059),p=t(87376),m=t(72791),h=t(57689),x=t(11087),g=t(48367),v=t(86081),Z=t(34242),w=t(94604),y=t(57841),j=t(81131),C=t(41473),b=t(55818),S=t(3721),M=t(36151),k=t(81918),I=t(58069),G=t(16386),H=t(80184);function T(e){var n,t=e.versions,a=(0,h.UO)().id,u=(0,g.CG)((function(e){return e.UI.tokenInfo})),l=(0,g.TL)();return a&&u?(0,H.jsx)(s.Z,{gap:2,children:(0,H.jsxs)(C.Z,{children:[(0,H.jsx)(b.Z,{expandIcon:(0,H.jsx)(j.Z,{}),sx:{my:0,minHeight:"0 !important",bgcolor:"#acf2",".Mui-expanded":{my:"12px"}},children:(0,H.jsx)(s.Z,{direction:"row",alignItems:"center",gap:1,children:(0,H.jsxs)(o.Z,{fontWeight:600,children:["\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 ",null===(n=t.find((function(e){return e.active})))||void 0===n?void 0:n.ver]})})}),(0,H.jsx)(S.Z,{children:(0,H.jsx)(I._,{rows:t,columns:[{field:"ver",headerName:"Version",width:100},{field:"name",headerName:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d",width:300},{field:"updatedAt",headerName:"\u66f4\u65b0\u65e5",width:180,renderCell:function(e){return(0,G.Z)(new Date(e.row.updatedAt),"yyyy\u5e74MM\u6708dd\u65e5 HH:mm")}},{field:"createdAt",headerName:"\u4f5c\u6210\u65e5",width:180,renderCell:function(e){return(0,G.Z)(new Date(e.row.createdAt),"yyyy\u5e74MM\u6708dd\u65e5 HH:mm")}},{field:"active",headerName:"\u52d5\u4f5c",renderCell:function(e){return e.row.active?(0,H.jsx)(k.Z,{label:"\u4f7f\u7528\u4e2d",size:"small",color:"success"}):(0,H.jsx)(M.Z,{variant:"outlined",sx:{p:0,px:1,m:0,minWidth:0},color:"secondary",size:"small",onClick:(0,i.Z)((0,r.Z)().mark((function n(){var t,i,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,window.confirm("\u4fdd\u5b58\u3057\u3066\u306a\u3044\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u5931\u308f\u308c\u307e\u3059\u3002\u5909\u66f4\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,c.f.active(e.row.id);case 6:t=n.sent,i=t.error,a=t.message,l(w.T9.addGlobalMessage({message:a,type:i?"error":"success"}));case 10:return n.prev=10,n.finish(10);case 12:case"end":return n.stop()}}),n,null,[[0,,10,12]])}))),children:"\u6709\u52b9\u306b\u3059\u308b"})}}],initialState:{pagination:{paginationModel:{page:0,pageSize:30}}},pageSizeOptions:[30,60],sx:{"& .MuiDataGrid-row":{},"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-cell:focus-within":{outline:"none"},"& .MuiDataGrid-columnHeaders":{bgcolor:"primary.dark",color:"#fff"},"& .MuiDataGrid-columnHeaders svg":{color:"#fff"}},getRowClassName:function(e){return""},density:"compact",hideFooterSelectedRowCount:!0,editMode:"cell",disableColumnMenu:!0,disableRowSelectionOnClick:!0})})]})}):null}function N(){var e=(0,h.UO)().id,n=(0,h.s0)(),t=(0,h.TH)(),j=(0,g.CG)((function(e){return e.UI.tokenInfo})),C=(0,g.TL)(),b=(0,g.CG)((function(e){return e.CMS.Template.status})),S=(0,g.CG)((function(e){return e.CMS.Template.list})),M=S.find((function(n){return n.id===Number(e)})),k=(0,m.useState)((function(){return(null===M||void 0===M?void 0:M.subOwner)||[]})),I=(0,a.Z)(k,2),G=I[0],N=I[1],z=(0,g.CG)((function(e){return e.CMS.Theme.status})),D=(0,g.CG)((function(e){return e.CMS.Theme.list}));(0,m.useEffect)((function(){"init"===z&&C((0,Z.RC)())}),[C,z]),(0,m.useEffect)((function(){"init"===b?C((0,v.uR)()):e&&!M&&n("/cms/template")}),[C,e,n,b,M]);var O=(0,m.useState)(),R=(0,a.Z)(O,2),U=R[0],W=R[1],A=(0,m.useState)(!1),E=(0,a.Z)(A,2),P=E[0],_=E[1],L=(0,g.CG)((function(e){return e.UI.currentPath}));if((0,m.useEffect)((function(){var e=L.find((function(e){return e.path===t.pathname}));e&&e.wsId!==window.wss.id?W(e.auth):W(void 0)}),[L,t.pathname]),U)return(0,H.jsx)(u.Z,{user:U});if(!e||!M||!j)return null;var V=D.find((function(e){return e.id===M.themeId}));return V?(0,H.jsxs)(s.Z,{gap:1,children:[(0,H.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:2,sx:{},children:[(0,H.jsx)(o.Z,{color:"primary.dark",sx:{fontWeight:600},children:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u8a2d\u5b9a"}),(0,H.jsx)(x.rU,{to:"/cms/template/".concat(e,"/delete"),state:{location:t},children:(0,H.jsx)(l.Z,{text:"\u524a\u9664",sx:{width:150,py:"2px",fontSize:14}})})]}),(0,H.jsx)(s.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:2,children:(0,H.jsx)(f.Z,{label:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d",value:M.name,apiEndpoint:"/api/cms/template/"+e,fieldName:"name",readOnly:j.permissions[p.g.CMS]<2})}),(0,H.jsx)(s.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:2,children:[2,3,6,7].includes(j.permissions[p.g.CMS])&&(0,H.jsx)(y.Z,{value:G,setValue:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N(n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})}),(0,H.jsx)(s.Z,{alignItems:"stretch",gap:1,children:(0,H.jsx)(s.Z,{flex:1,justifyContent:"center",alignItems:"center",position:"relative",zIndex:99,bgcolor:"#3ac2",p:.5,sx:{border:"1px solid #ccc"},children:(0,H.jsx)(d.Z,{theme:V,style:M.style,script:M.script,formStyle:M.formStyle,formScript:M.formScript,bodyCode:M.body,handleSavePage:function(){var n=(0,i.Z)((0,r.Z)().mark((function n(t,i,a,s,o){var u,l,d;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,_(!0),n.next=4,c.f.update({id:e,body:t,subOwner:G,style:i,script:a,formScript:o,formStyle:s});case 4:u=n.sent,l=u.error,d=u.message,C(w.T9.addGlobalMessage({message:d,type:l?"error":"success"}));case 8:return n.prev=8,_(!1),n.finish(8);case 11:case"end":return n.stop()}}),n,null,[[0,,8,11]])})));return function(e,t,r,i,a){return n.apply(this,arguments)}}(),loading:P})})}),(0,H.jsx)(T,{versions:S.filter((function(e){return e.uuid===M.uuid}))})]}):null}}}]);
//# sourceMappingURL=880.7b32b621.chunk.js.map