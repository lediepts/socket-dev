"use strict";(self.webpackChunkcaa_client=self.webpackChunkcaa_client||[]).push([[5549],{61059:function(e,n,r){r.d(n,{Z:function(){return N}});var t=r(1413),i=r(74165),a=r(4942),s=r(15861),o=r(29439),l=r(44695),c=r(39709),u=r(68870),d=r(53767),m=r(27391),f=r(63466),p=r(36151),v=r(20890),x=r(66888),Z=r(16386),g=r(72791),h=r(61134),j=r(78820),y=r(20458),b=r(48367),C=r(94604),S=r(60251),w=r(81724),M=r(80184);function N(e){var n,r=e.apiEndpoint,N=e.fieldName,k=(e.max,e.min,e.multiline),I=e.rows,R=e.label,W=e.subText,z=e.value,V=void 0===z?"":z,E=e.required,T=void 0!==E&&E,O=e.datePicker,P=e.readOnly,U=e.useGroupName,G=e.group,q=e.render,B=w.Ry({}),L=(0,b.TL)(),D=(0,g.useState)(!1),H=(0,o.Z)(D,2),A=H[0],F=H[1],_=(0,g.useState)(!1),J=(0,o.Z)(_,2),K=J[0],X=J[1],Q=(0,g.useRef)(null),Y=(0,h.cI)({resolver:(0,l.X)(B),defaultValues:{value:O?V?new Date(V):null:U&&"string"===typeof V?V.replace("[".concat(null===G||void 0===G?void 0:G.name,"]"),""):V}}),$=Y.register,ee=Y.handleSubmit,ne=Y.formState.errors,re=Y.setValue,te=Y.getValues,ie=Y.setError,ae=Y.reset;(0,g.useEffect)((function(){if(V){var e=U&&"string"===typeof V?V.replace("[".concat(null===G||void 0===G?void 0:G.name,"]"),""):V;re("value",e,{shouldValidate:!0})}}),[V]),(0,g.useEffect)((function(){var e,n,r,t;Q.current&&(K?(null===(e=Q.current.querySelector("input"))||void 0===e||e.focus(),null===(n=Q.current.querySelector("input"))||void 0===n||n.focus()):(null===(r=Q.current.querySelector("input"))||void 0===r||r.blur(),null===(t=Q.current.querySelector("input"))||void 0===t||t.blur()))}),[K]);var se=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(n){var t,s,o,l,c,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.value,!r||!N){e.next=17;break}return F(!0),e.prev=3,e.next=6,S.Z.put(r,(0,a.Z)({},N,U&&"string"===typeof t?"[".concat(null===G||void 0===G?void 0:G.name,"]").concat(t):t));case 6:s=e.sent,o=s.data,l=o.message,c=void 0===l?"":l,u=o.error,X(!1),L(C.T9.addGlobalMessage({message:c,type:u?"error":"success"})),ae();case 14:return e.prev=14,F(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,,14,17]])})));return function(n){return e.apply(this,arguments)}}();return(0,M.jsx)(u.Z,{component:"form",noValidate:!0,autoComplete:"off",onSubmit:ee(se),my:1,children:K?(0,M.jsxs)(d.Z,{direction:{md:"row",xs:"column"},alignItems:"center",sx:{display:K?"flex":"none",maxWidth:{md:500,xs:300}},ref:Q,children:[O?(0,M.jsx)(x.M,{label:R,inputFormat:"yyyy\u5e74MM\u6708dd\u65e5",value:te("value")||null,onChange:function(e){e&&e instanceof Date&&!isNaN(e.valueOf())&&re("value",e,{shouldValidate:!0})},onError:function(e){ie("value",{message:null===e||void 0===e?void 0:e.toString()})},renderInput:function(e){return(0,M.jsx)(m.Z,(0,t.Z)((0,t.Z)({required:T},e),{},{size:"small"}))}}):(0,M.jsx)(m.Z,(0,t.Z)((0,t.Z)({variant:k?"outlined":"standard",required:T,margin:"none",size:"small",fullWidth:!0,label:R,multiline:k,rows:I,onKeyDown:function(e){"Escape"===e.key&&(X(!1),re("value",V,{shouldValidate:!0}))},InputProps:U?{startAdornment:(0,M.jsxs)(f.Z,{position:"start",children:["[",null===G||void 0===G?void 0:G.name,"]"]})}:void 0},$("value")),{},{error:"name"in ne,helperText:null===(n=ne.value)||void 0===n?void 0:n.message})),(0,M.jsxs)(d.Z,{direction:"row",sx:{my:1},children:[(0,M.jsx)(p.Z,{sx:{mx:.5,px:.5,minWidth:0},size:"small",color:"error",variant:"outlined",onClick:function(){X(!1),re("value",V,{shouldValidate:!0})},children:(0,M.jsx)(j.SV5,{className:"text-lg"})}),(0,M.jsx)(c.Z,{disabled:Object.keys(ne).length>0,loading:A,sx:{mx:.5,px:.5,minWidth:0},size:"small",variant:"outlined",type:"submit",children:(0,M.jsx)(j.JMf,{className:"text-lg"})})]})]}):(0,M.jsxs)(d.Z,{direction:{md:"row",xs:"column"},spacing:2,sx:{display:K?"none":"flex"},alignItems:{md:"center",xs:"flex-start"},children:[(0,M.jsx)(v.Z,{fontWeight:"bold",variant:"body2",flex:"none",children:R}),(0,M.jsxs)(d.Z,{direction:"row",alignItems:"center",children:[q?q():O||"string"!==typeof V?(0,M.jsx)(v.Z,{children:V?"string"!==typeof V?(0,Z.Z)(V,"yyyy\u5e74MM\u6708dd\u65e5"):(0,Z.Z)(new Date(V),"yyyy\u5e74MM\u6708dd\u65e5"):"--"}):(0,M.jsx)(v.Z,{sx:{color:Boolean(V.trim())?"":"#aaa"},children:V.trim()||"\u672a\u8a2d\u5b9a"}),(0,M.jsx)(v.Z,{mx:1,children:W}),!P&&(0,M.jsx)(p.Z,{sx:{flex:"none",mx:1,p:.2,minWidth:0},size:"small",variant:"outlined",color:"info",onClick:function(){X(!0)},children:(0,M.jsx)(y.FNg,{className:"text-lg"})})]})]})})}},96937:function(e,n,r){r.r(n),r.d(n,{default:function(){return F}});var t=r(74165),i=r(15861),a=r(29439),s=r(27247),o=r(53767),l=r(20890),c=r(36151),u=r(94721),d=r(87462),m=r(63366),f=r(72791),p=r(28182),v=r(94419),x=r(66934),Z=r(31402),g=r(35527),h=r(75878),j=r(21217);function y(e){return(0,j.Z)("MuiCard",e)}(0,h.Z)("MuiCard",["root"]);var b=r(80184),C=["className","raised"],S=(0,x.ZP)(g.Z,{name:"MuiCard",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(){return{overflow:"hidden"}})),w=f.forwardRef((function(e,n){var r=(0,Z.Z)({props:e,name:"MuiCard"}),t=r.className,i=r.raised,a=void 0!==i&&i,s=(0,m.Z)(r,C),o=(0,d.Z)({},r,{raised:a}),l=function(e){var n=e.classes;return(0,v.Z)({root:["root"]},y,n)}(o);return(0,b.jsx)(S,(0,d.Z)({className:(0,p.Z)(l.root,t),elevation:a?8:void 0,ref:n,ownerState:o},s))}));function M(e){return(0,j.Z)("MuiCardContent",e)}(0,h.Z)("MuiCardContent",["root"]);var N=["className","component"],k=(0,x.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(){return{padding:16,"&:last-child":{paddingBottom:24}}})),I=f.forwardRef((function(e,n){var r=(0,Z.Z)({props:e,name:"MuiCardContent"}),t=r.className,i=r.component,a=void 0===i?"div":i,s=(0,m.Z)(r,N),o=(0,d.Z)({},r,{component:a}),l=function(e){var n=e.classes;return(0,v.Z)({root:["root"]},M,n)}(o);return(0,b.jsx)(k,(0,d.Z)({as:a,className:(0,p.Z)(l.root,t),ownerState:o,ref:n},s))})),R=r(13400);function W(e){return(0,j.Z)("MuiCardActions",e)}(0,h.Z)("MuiCardActions",["root","spacing"]);var z=["disableSpacing","className"],V=(0,x.ZP)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:function(e,n){var r=e.ownerState;return[n.root,!r.disableSpacing&&n.spacing]}})((function(e){var n=e.ownerState;return(0,d.Z)({display:"flex",alignItems:"center",padding:8},!n.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})})),E=f.forwardRef((function(e,n){var r=(0,Z.Z)({props:e,name:"MuiCardActions"}),t=r.disableSpacing,i=void 0!==t&&t,a=r.className,s=(0,m.Z)(r,z),o=(0,d.Z)({},r,{disableSpacing:i}),l=function(e){var n=e.classes,r={root:["root",!e.disableSpacing&&"spacing"]};return(0,v.Z)(r,W,n)}(o);return(0,b.jsx)(V,(0,d.Z)({className:(0,p.Z)(l.root,a),ownerState:o,ref:n},s))})),T=r(61059),O=r(57689),P=r(11087),U=r(48367),G=r(38100),q=r(21164),B=r(12457),L=r(89511),D=r(87376),H=r(67584),A=r(94604);function F(){var e=(0,U.TL)(),n=(0,O.TH)(),r=(0,U.CG)((function(e){return e.CMS.Web.list})),d=(0,U.CG)((function(e){return e.CMS.Web.status})),m=(0,U.CG)((function(e){return e.UI.tokenInfo})),p=(0,f.useState)(!1),v=(0,a.Z)(p,2),x=v[0],Z=v[1],g=(0,f.useState)(0),h=(0,a.Z)(g,2),j=h[0],y=h[1],C=(0,f.useState)(),S=(0,a.Z)(C,2),M=S[0],N=S[1],k=(0,f.useState)(0),W=(0,a.Z)(k,2),z=W[0],V=W[1],F=(0,f.useState)(),_=(0,a.Z)(F,2),J=_[0],K=_[1];return(0,f.useEffect)((function(){"init"===d&&e((0,G.PI)())}),[d,e]),m?(0,b.jsxs)(o.Z,{gap:1,children:[z>0&&(0,b.jsx)(B.Z,{open:!0,title:"",maxWidth:"lg",primaryButtonColor:"success",primaryButtonText:"\u8a2d\u5b9a",disabled:!J,loading:x,handleClose:function(){V(0)},handleSubmit:(0,i.Z)((0,t.Z)().mark((function n(){var r,i,a;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(J){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,Z(!0),n.next=6,H.P.update({id:z,favicon:J.name});case 6:r=n.sent,i=r.error,a=r.message,e(A.T9.addGlobalMessage({message:a,type:i?"error":"success"}));case 10:return n.prev=10,Z(!1),V(0),n.finish(10);case 14:case"end":return n.stop()}}),n,null,[[2,,10,14]])}))),children:(0,b.jsx)(L.Z,{handleSelect:function(e){K(e)},select:J,onlyUse:"img",imgSize:100,maxHeight:200})}),j>0&&(0,b.jsx)(B.Z,{open:!0,title:"",maxWidth:"lg",primaryButtonColor:"success",primaryButtonText:"\u8a2d\u5b9a",disabled:!M,loading:x,handleClose:function(){y(0)},handleSubmit:(0,i.Z)((0,t.Z)().mark((function n(){var r,i,a;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(M){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,Z(!0),n.next=6,H.P.update({id:j,ogImage:M.name});case 6:r=n.sent,i=r.error,a=r.message,e(A.T9.addGlobalMessage({message:a,type:i?"error":"success"}));case 10:return n.prev=10,Z(!1),y(0),n.finish(10);case 14:case"end":return n.stop()}}),n,null,[[2,,10,14]])}))),children:(0,b.jsx)(L.Z,{handleSelect:function(e){N(e)},select:M,onlyUse:"img",imgSize:100,maxHeight:200})}),(0,b.jsxs)(o.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:2,sx:{},children:[(0,b.jsx)(l.Z,{sx:{fontWeight:600},variant:"h5",children:"Web\u30b5\u30a4\u30c8\u4e00\u89a7\u7ba1\u7406"}),m.permissions[D.g.CMS]>1&&(0,b.jsx)(P.rU,{to:"/cms/website/create",children:(0,b.jsx)(c.Z,{variant:"outlined",sx:{minWidth:120},children:"\u65b0\u898f\u4f5c\u6210"})})]}),(0,b.jsx)(u.Z,{}),(0,b.jsx)(o.Z,{gap:2,children:r.map((function(e){return(0,b.jsxs)(w,{elevation:2,children:[(0,b.jsxs)(I,{children:[(0,b.jsx)(l.Z,{gutterBottom:!0,variant:"h5",component:"div",children:e.name}),(0,b.jsxs)(o.Z,{gap:1,children:[(0,b.jsx)(T.Z,{label:"URL",value:e.ogURL,apiEndpoint:"/api/cms/web/"+e.id,fieldName:"ogURL",readOnly:m.permissions[D.g.CMS]<2}),(0,b.jsx)(T.Z,{label:"\u540d\u524d",value:e.name,apiEndpoint:"/api/cms/web/"+e.id,fieldName:"name",readOnly:m.permissions[D.g.CMS]<2}),(0,b.jsxs)(o.Z,{direction:"row",gap:1,alignItems:"center",children:[(0,b.jsx)(T.Z,{label:"Favicon",value:e.favicon,readOnly:!0}),m.permissions[D.g.CMS]>1&&(0,b.jsx)(R.Z,{onClick:function(){V(e.id)},children:(0,b.jsx)(q.Z,{})})]}),(0,b.jsxs)(o.Z,{direction:"row",gap:1,alignItems:"center",children:[(0,b.jsx)(T.Z,{label:"OGP\u753b\u50cf",value:e.ogImage,readOnly:!0}),m.permissions[D.g.CMS]>1&&(0,b.jsx)(R.Z,{onClick:function(){y(e.id)},children:(0,b.jsx)(q.Z,{})})]}),(0,b.jsx)(T.Z,{label:"\u8aac\u660e",value:e.ogDescription,apiEndpoint:"/api/cms/web/"+e.id,fieldName:"ogDescription",multiline:!0,rows:4,readOnly:m.permissions[D.g.CMS]<2})]})]}),m.permissions[D.g.CMS]>1&&(0,b.jsxs)(E,{sx:{justifyContent:"space-between"},children:[(0,b.jsx)(P.rU,{to:"/cms/website/".concat(e.id,"/delete"),state:{location:n},children:(0,b.jsx)(c.Z,{color:"error",variant:"outlined",size:"small",endIcon:(0,b.jsx)(s.Z,{}),children:"\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u524a\u9664"})}),(0,b.jsx)(P.rU,{to:"/cms/".concat(e.id,"/page"),children:(0,b.jsx)(c.Z,{color:"info",variant:"contained",children:"\u30da\u30fc\u30b8\u4e00\u89a7\u7ba1\u7406"})})]})]},e.id)}))})]}):null}},21164:function(e,n,r){var t=r(64836);n.Z=void 0;var i=t(r(45649)),a=r(80184),s=(0,i.default)((0,a.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"Link");n.Z=s}}]);
//# sourceMappingURL=5549.77e99eee.chunk.js.map