"use strict";(self.webpackChunkcaa_client=self.webpackChunkcaa_client||[]).push([[8769],{37235:function(e,n,r){r.r(n),r.d(n,{default:function(){return O}});var t=r(74165),i=r(15861),s=r(29439),a=r(53767),o=r(20890),c=r(80950),u=r(43859),l=r(98074),d=r(61059),f=r(57841),p=r(87376),m=r(72791),x=r(57689),h=r(11087),g=r(48367),v=r(49822),w=r(34242),y=r(94604),Z=r(81131),C=r(41473),b=r(55818),j=r(3721),S=r(36151),M=r(81918),k=r(58069),G=r(16386),I=r(80184);function N(e){var n,r=e.versions,s=(0,x.UO)(),u=s.id,l=s.webId,d=(0,g.CG)((function(e){return e.UI.tokenInfo})),f=(0,g.TL)(),p=(0,g.CG)((function(e){return e.CMS.Page.list})).find((function(e){return e.id===Number(u)}));return u&&p&&d&&l?(0,I.jsx)(a.Z,{gap:2,children:(0,I.jsxs)(C.Z,{children:[(0,I.jsx)(b.Z,{expandIcon:(0,I.jsx)(Z.Z,{}),sx:{my:0,minHeight:"0 !important",bgcolor:"#acf2",".Mui-expanded":{my:"12px"}},children:(0,I.jsx)(a.Z,{direction:"row",alignItems:"center",gap:1,children:(0,I.jsxs)(o.Z,{fontWeight:600,children:["\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 ",null===(n=r.find((function(e){return e.active})))||void 0===n?void 0:n.ver]})})}),(0,I.jsx)(j.Z,{children:(0,I.jsx)(k._,{rows:r,columns:[{field:"ver",headerName:"Version",width:100},{field:"updatedAt",headerName:"\u66f4\u65b0\u65e5",width:180,renderCell:function(e){return(0,G.Z)(new Date(e.row.updatedAt),"yyyy\u5e74MM\u6708dd\u65e5 HH:mm")}},{field:"createdAt",headerName:"\u4f5c\u6210\u65e5",width:140,renderCell:function(e){return(0,G.Z)(new Date(e.row.createdAt),"yyyy\u5e74MM\u6708dd\u65e5")}},{field:"active",headerName:"\u52d5\u4f5c",renderCell:function(e){return e.row.active?(0,I.jsx)(M.Z,{label:"\u4f7f\u7528\u4e2d",size:"small",color:"success"}):(0,I.jsx)(S.Z,{variant:"outlined",sx:{p:0,px:1,m:0,minWidth:0},color:"secondary",size:"small",onClick:(0,i.Z)((0,t.Z)().mark((function n(){var r,i,s;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,window.confirm("\u4fdd\u5b58\u3057\u3066\u306a\u3044\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u5931\u308f\u308c\u307e\u3059\u3002\u5909\u66f4\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,c.S.active(e.row.id);case 6:r=n.sent,i=r.error,s=r.message,f(y.T9.addGlobalMessage({message:s,type:i?"error":"success"}));case 10:return n.prev=10,n.finish(10);case 12:case"end":return n.stop()}}),n,null,[[0,,10,12]])}))),children:"\u6709\u52b9\u306b\u3059\u308b"})}}],initialState:{pagination:{paginationModel:{page:0,pageSize:30}}},pageSizeOptions:[30,60],sx:{"& .MuiDataGrid-row":{},"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-cell:focus-within":{outline:"none"},"& .MuiDataGrid-columnHeaders":{bgcolor:"primary.dark",color:"#fff"},"& .MuiDataGrid-columnHeaders svg":{color:"#fff"}},getRowClassName:function(e){return""},density:"compact",hideFooterSelectedRowCount:!0,editMode:"cell",disableColumnMenu:!0,disableRowSelectionOnClick:!0})})]})}):null}function O(){var e=(0,x.UO)(),n=e.id,r=e.webId,Z=(0,x.s0)(),C=(0,x.TH)(),b=(0,g.CG)((function(e){return e.UI.tokenInfo})),j=(0,g.TL)(),S=(0,m.useState)(!1),M=(0,s.Z)(S,2),k=M[0],G=M[1],O=(0,g.CG)((function(e){return e.CMS.Page.status})),D=(0,g.CG)((function(e){return e.CMS.Page.list})),T=D.find((function(e){return e.id===Number(n)})),U=(0,m.useState)((function(){return(null===T||void 0===T?void 0:T.subOwner)||[]})),z=(0,s.Z)(U,2),H=z[0],E=z[1],R=(0,g.CG)((function(e){return e.CMS.Theme.status})),A=(0,g.CG)((function(e){return e.CMS.Theme.list}));if((0,m.useEffect)((function(){"init"===R&&j((0,w.RC)())}),[j,R]),(0,m.useEffect)((function(){"init"===O?j((0,v.UQ)()):n&&!T&&Z(-1)}),[j,n,Z,O,T]),!n||!T||!b)return null;var P=A.find((function(e){return e.id===T.themeId}));return P?(0,I.jsxs)(a.Z,{gap:1,children:[(0,I.jsxs)(a.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:2,sx:{},children:[(0,I.jsx)(o.Z,{color:"primary.dark",variant:"h5",sx:{fontWeight:600},children:"\u30da\u30fc\u30b8\u8a2d\u5b9a"}),(0,I.jsx)(h.rU,{to:"/cms/".concat(r,"/page/").concat(n,"/delete"),state:{location:C},children:(0,I.jsx)(u.Z,{text:"\u524a\u9664",sx:{width:150,py:"2px",fontSize:14}})})]}),(0,I.jsxs)(a.Z,{gap:1,my:2,children:[(0,I.jsx)(d.Z,{label:"\u30da\u30fc\u30b8URL",value:T.url,apiEndpoint:"/api/cms/page/"+n,fieldName:"url",readOnly:b.permissions[p.g.CMS]<2}),(0,I.jsx)(d.Z,{label:"\u30da\u30fc\u30b8\u540d",value:T.title,apiEndpoint:"/api/cms/page/"+n,fieldName:"title",readOnly:b.permissions[p.g.CMS]<2}),(0,I.jsx)(d.Z,{label:"\u30da\u30fc\u30b8\u8aac\u660e",value:T.description,multiline:!0,rows:5,apiEndpoint:"/api/cms/page/"+n,fieldName:"description",readOnly:b.permissions[p.g.CMS]<2}),[2,3,6,7].includes(b.permissions[p.g.CMS])&&(0,I.jsx)(f.Z,{value:H,setValue:function(){var e=(0,i.Z)((0,t.Z)().mark((function e(n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})]}),(0,I.jsx)(a.Z,{alignItems:"stretch",gap:1,children:(0,I.jsx)(a.Z,{flex:1,justifyContent:"center",alignItems:"center",position:"relative",zIndex:99,bgcolor:"#3ac2",p:.5,sx:{border:"1px solid #ccc"},children:(0,I.jsx)(l.Z,{theme:P,bodyCode:T.body,style:T.style,script:T.script,formStyle:T.formStyle,formScript:T.formScript,handleSavePage:function(){var e=(0,i.Z)((0,t.Z)().mark((function e(r,i,s,a,o){var u,l,d;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G(!0),e.next=4,c.S.update({id:n,body:r,subOwner:H,style:i,script:s,formScript:o,formStyle:a});case 4:u=e.sent,l=u.error,d=u.message,j(y.T9.addGlobalMessage({message:d,type:l?"error":"success"}));case 8:return e.prev=8,G(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,,8,11]])})));return function(n,r,t,i,s){return e.apply(this,arguments)}}(),loading:k})})}),(0,I.jsx)(N,{versions:D.filter((function(e){return e.uuid===T.uuid}))})]}):null}}}]);
//# sourceMappingURL=8769.cb31657d.chunk.js.map